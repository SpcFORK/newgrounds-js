var q=Object.defineProperty;var x=(s,p)=>q(s,"name",{value:p,configurable:!0});function I(s,p=0,l){var y,S,m,w,k,C,D;this.appID=s,this.cipher=p,this.medalDisplayTime=l.medalDisplayTime||5,this.showPopups=l.showPopups||!0,this.showDescriptions=l.showDescriptions||!0,this.debug=l.debug||!1,this.points=[5,10,25,50,100],this.displayMedalQueue=[];let o=new URL(window.location.href);this.sessionID=(y=o.searchParams.get("ngio_session_id"))!=null?y:0;let a=this.call("ScoreBoard.getBoards",0,0);this.scoreboards=(w=(m=(S=a==null?void 0:a.result)==null?void 0:S.data)==null?void 0:m.scoreboards)!=null?w:[];let g=this.call("Medal.getList",0,0);this.medals=(D=(C=(k=g==null?void 0:g.result)==null?void 0:k.data)==null?void 0:C.medals)!=null?D:[];for(let i of this.medals)i.image=new Image,i.image.src=i.icon,this.debug&&(i.unlocked=0)}x(I,"init");function F(s){if(!this.medals||!this.medals.find(l=>l.id==s))return;let p=this.medals.find(l=>l.id==s);p.unlocked||(p.unlocked=!0,this.call("Medal.unlock",{id:p.id}))}x(F,"unlockMedal");function j(s){return unescape(s.name+" ("+this.points[s.difficulty-1]+")"+(this.showDescriptions?" - "+s.description:""))}x(j,"getMedalText");function J(s,p=0,l="A",o=0,a=0,g=10){var m,w;if(!this.scoreboards||!this.scoreboards.find(k=>k.id==s))return;let y=this.scoreboards.find(k=>k.id==s);return(w=(m=this.call("ScoreBoard.getScores",{id:y.id,user:p,period:l,social:o,skip:a,limit:g},0).result)==null?void 0:m.data)==null?void 0:w.scores}x(J,"getScores");function N(s,p){if(!this.scoreboards||!this.scoreboards.find(o=>o.id==s))return;let l=this.scoreboards.find(o=>o.id==s);this.call("ScoreBoard.postScore",{id:l.id,value:p})}x(N,"postScore");function V(s,p,l,o,a,g=.5){if(!this.medals||!this.medals.find(w=>w.id==p))return;s.save(),s.fillStyle="#fff",s.strokeStyle="#000",s.shadowColor="#000",s.textBaseline="middle",s.textAlign="left",s.font=a/2+"px impact",s.lineWidth=a/35,s.shadowBlur=a/5,s.globalAlpha=g;let y=this.medals.find(w=>w.id==p);s.drawImage(y.image,l,o,a,a),s.strokeRect(l,o,a,a);let S=this.points[y.difficulty-1],m=this.getMedalText(y);s.lineWidth=Math.max(1,a/26),s.strokeText(m,l+a*1.2,o+a/2),s.fillText(m,l+a*1.2,o+a/2),s.restore()}x(V,"renderMedal");function L(s){var p;if((p=this.displayMedalQueue)==null?void 0:p.length){let l=this.displayMedalQueue[0];l.time+=s,l.time>this.medalDisplayTime&&this.displayMedalQueue.shift()}}x(L,"update");function U(s,p=50){var l;if((l=this.displayMedalQueue)==null?void 0:l.length){let o=this.displayMedalQueue[0],a=o.time<1?1-o.time:0,g=o.time>this.medalDisplayTime-1?this.medalDisplayTime-o.time:1,y=s.canvas.height+a*p*1.5;V(s,o.index,0,y-p,p,g)}}x(U,"render");function X(){var p,l,o,a;let s=this.call("App.checkSession");return(a=(o=(l=(p=s==null?void 0:s.result)==null?void 0:p.data)==null?void 0:l.session)==null?void 0:o.user)==null?void 0:a.name}x(X,"username");function Q(){var p,l;let s=this.call("App.getCurrentVersion");return(l=(p=s==null?void 0:s.result)==null?void 0:p.data)==null?void 0:l.current_version}x(Q,"version");function W(){var p,l,o,a;let s=this.call("App.checkSession");return(a=(o=(l=(p=s==null?void 0:s.result)==null?void 0:p.data)==null?void 0:l.session)==null?void 0:o.user)==null?void 0:a.supporter}x(W,"isSupporter");function $(s){if(!this.cipher)return s;let p=this.CryptoJS.enc.Base64.parse(this.cipher),l=this.CryptoJS.lib.WordArray.random(16),o=this.CryptoJS.AES.encrypt(JSON.stringify(s),p,{iv:l}),a=this.CryptoJS.enc.Base64.stringify(l.concat(o.ciphertext));return s.secure=a,s.parameters=null,s}x($,"encryptCall");function H(s,p=0,l=1){let o=$({component:s,parameters:p}),a={app_id:this.appID,session_id:this.sessionID,call:o},g=new FormData;g.append("input",JSON.stringify(a));let y=new XMLHttpRequest,S="https://newgrounds.io/gateway_v3.php";if(y.open("POST",S,this.debug?0:l),y.send(g),y.responseText)return this.debug&&console.log(y.responseText),this.responseText=y.responseText,JSON.parse(y.responseText)}x(H,"call");var K={init:I,unlockMedal:F,getMedalText:j,getScores:J,postScore:N,update:L,render:U,username:X,version:Q,isSuporter:W,call:H};(function(s,p){typeof exports=="object"?module.exports=exports=p():typeof define=="function"&&define.amd?define([],p):K.CryptoJS=p()})(0,function(){var s=s||function(p,l){var o;if(typeof window!="undefined"&&window.crypto&&(o=window.crypto),!o&&typeof window!="undefined"&&window.msCrypto&&(o=window.msCrypto),!o&&typeof global!="undefined"&&global.crypto&&(o=global.crypto),!o&&typeof require=="function")try{o=require("crypto")}catch(i){}var a=x(function(){if(o){if(typeof o.getRandomValues=="function")try{return o.getRandomValues(new Uint32Array(1))[0]}catch(i){}if(typeof o.randomBytes=="function")try{return o.randomBytes(4).readInt32LE()}catch(i){}}throw new Error("Native crypto module could not be used to get secure random number.")},"i"),g=Object.create||function(){function i(){}return x(i,"t"),function(f){var _;return i.prototype=f,_=new i,i.prototype=null,_}}(),y={},S=y.lib={},m=S.Base={extend:function(i){var f=g(this);return i&&f.mixIn(i),f.hasOwnProperty("init")&&this.init!==f.init||(f.init=function(){f.$super.init.apply(this,arguments)}),f.init.prototype=f,f.$super=this,f},create:function(){var i=this.extend();return i.init.apply(i,arguments),i},init:function(){},mixIn:function(i){for(var f in i)i.hasOwnProperty(f)&&(this[f]=i[f]);i.hasOwnProperty("toString")&&(this.toString=i.toString)},clone:function(){return this.init.prototype.extend(this)}},w=S.WordArray=m.extend({init:function(i,f){i=this.words=i||[],this.sigBytes=f!=null?f:4*i.length},toString:function(i){return(i||Hex).stringify(this)},concat:function(i){var f=this.words,_=i.words,u=this.sigBytes,h=i.sigBytes;if(this.clamp(),u%4)for(var c=0;c<h;c++){var B=_[c>>>2]>>>24-c%4*8&255;f[u+c>>>2]|=B<<24-(u+c)%4*8}else for(c=0;c<h;c+=4)f[u+c>>>2]=_[c>>>2];return this.sigBytes+=h,this},clamp:function(){var i=this.words,f=this.sigBytes;i[f>>>2]&=4294967295<<32-f%4*8,i.length=p.ceil(f/4)},clone:function(){var i=m.clone.call(this);return i.words=this.words.slice(0),i},random:function(i){for(var f=[],_=0;_<i;_+=4)f.push(a());return new w.init(f,i)}}),k=y.enc={},C=k.Latin1={stringify:function(i){for(var f=i.words,_=i.sigBytes,u=[],h=0;h<_;h++){var c=f[h>>>2]>>>24-h%4*8&255;u.push(String.fromCharCode(c))}return u.join("")},parse:function(i){for(var f=i.length,_=[],u=0;u<f;u++)_[u>>>2]|=(255&i.charCodeAt(u))<<24-u%4*8;return new w.init(_,f)}},D=k.Utf8={stringify:function(i){try{return decodeURIComponent(escape(C.stringify(i)))}catch(f){throw new Error("Malformed UTF-8 data")}},parse:function(i){return C.parse(unescape(encodeURIComponent(i)))}};return S.BufferedBlockAlgorithm=m.extend({reset:function(){this._data=new w.init,this._nDataBytes=0},_append:function(i){typeof i=="string"&&(i=D.parse(i)),this._data.concat(i),this._nDataBytes+=i.sigBytes},_process:function(i){var f,_=this._data,u=_.words,h=_.sigBytes,c=this.blockSize,B=h/(4*c),e=(B=i?p.ceil(B):p.max((0|B)-this._minBufferSize,0))*c,r=p.min(4*e,h);if(e){for(var d=0;d<e;d+=c)this._doProcessBlock(u,d);f=u.splice(0,e),_.sigBytes-=r}return new w.init(f,r)},clone:function(){var i=m.clone.call(this);return i._data=this._data.clone(),i},_minBufferSize:0}),y.algo={},y}(Math);return function(){var p=s,l=p.lib.WordArray;p.enc.Base64={stringify:function(o){var a=o.words,g=o.sigBytes,y=this._map;o.clamp();for(var S=[],m=0;m<g;m+=3)for(var w=(a[m>>>2]>>>24-m%4*8&255)<<16|(a[m+1>>>2]>>>24-(m+1)%4*8&255)<<8|a[m+2>>>2]>>>24-(m+2)%4*8&255,k=0;k<4&&m+.75*k<g;k++)S.push(y.charAt(w>>>6*(3-k)&63));var C=y.charAt(64);if(C)for(;S.length%4;)S.push(C);return S.join("")},parse:function(o){var a=o.length,g=this._map,y=this._reverseMap;if(!y){y=this._reverseMap=[];for(var S=0;S<g.length;S++)y[g.charCodeAt(S)]=S}var m=g.charAt(64);if(m){var w=o.indexOf(m);w!==-1&&(a=w)}return function(k,C,D){for(var i=[],f=0,_=0;_<C;_++)if(_%4){var u=D[k.charCodeAt(_-1)]<<_%4*2,h=D[k.charCodeAt(_)]>>>6-_%4*2,c=u|h;i[f>>>2]|=c<<24-f%4*8,f++}return l.create(i,f)}(o,a,y)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),s.lib.Cipher||function(p){var l=s,o=l.lib,a=o.Base,g=o.WordArray,y=o.BufferedBlockAlgorithm,S=l.enc,m=(S.Utf8,S.Base64),w=l.algo.EvpKDF,k=o.Cipher=y.extend({cfg:a.extend(),createEncryptor:function(e,r){return this.create(this._ENC_XFORM_MODE,e,r)},createDecryptor:function(e,r){return this.create(this._DEC_XFORM_MODE,e,r)},init:function(e,r,d){this.cfg=this.cfg.extend(d),this._xformMode=e,this._key=r,this.reset()},reset:function(){y.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(r){return typeof r=="string"?B:h}return x(e,"t"),function(r){return{encrypt:function(d,t,n){return e(t).encrypt(r,d,t,n)},decrypt:function(d,t,n){return e(t).decrypt(r,d,t,n)}}}}()}),C=(o.StreamCipher=k.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),l.mode={}),D=o.BlockCipherMode=a.extend({createEncryptor:function(e,r){return this.Encryptor.create(e,r)},createDecryptor:function(e,r){return this.Decryptor.create(e,r)},init:function(e,r){this._cipher=e,this._iv=r}}),i=C.CBC=function(){var e=D.extend();function r(d,t,n){var v,b=this._iv;b?(v=b,this._iv=p):v=this._prevBlock;for(var M=0;M<n;M++)d[t+M]^=v[M]}return x(r,"r"),e.Encryptor=e.extend({processBlock:function(d,t){var n=this._cipher,v=n.blockSize;r.call(this,d,t,v),n.encryptBlock(d,t),this._prevBlock=d.slice(t,t+v)}}),e.Decryptor=e.extend({processBlock:function(d,t){var n=this._cipher,v=n.blockSize,b=d.slice(t,t+v);n.decryptBlock(d,t),r.call(this,d,t,v),this._prevBlock=b}}),e}(),f=(l.pad={}).Pkcs7={pad:function(e,r){for(var d=4*r,t=d-e.sigBytes%d,n=t<<24|t<<16|t<<8|t,v=[],b=0;b<t;b+=4)v.push(n);var M=g.create(v,t);e.concat(M)},unpad:function(e){var r=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=r}},_=(o.BlockCipher=k.extend({cfg:k.cfg.extend({mode:i,padding:f}),reset:function(){var e;k.reset.call(this);var r=this.cfg,d=r.iv,t=r.mode;this._xformMode==this._ENC_XFORM_MODE?e=t.createEncryptor:(e=t.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,d&&d.words):(this._mode=e.call(t,this,d&&d.words),this._mode.__creator=e)},_doProcessBlock:function(e,r){this._mode.processBlock(e,r)},_doFinalize:function(){var e,r=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(r.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),r.unpad(e)),e},blockSize:4}),o.CipherParams=a.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),u=(l.format={}).OpenSSL={stringify:function(e){var r=e.ciphertext,d=e.salt;return(d?g.create([1398893684,1701076831]).concat(d).concat(r):r).toString(m)},parse:function(e){var r,d=m.parse(e),t=d.words;return t[0]==1398893684&&t[1]==1701076831&&(r=g.create(t.slice(2,4)),t.splice(0,4),d.sigBytes-=16),_.create({ciphertext:d,salt:r})}},h=o.SerializableCipher=a.extend({cfg:a.extend({format:u}),encrypt:function(e,r,d,t){t=this.cfg.extend(t);var n=e.createEncryptor(d,t),v=n.finalize(r),b=n.cfg;return _.create({ciphertext:v,key:d,iv:b.iv,algorithm:e,mode:b.mode,padding:b.padding,blockSize:e.blockSize,formatter:t.format})},decrypt:function(e,r,d,t){return t=this.cfg.extend(t),r=this._parse(r,t.format),e.createDecryptor(d,t).finalize(r.ciphertext)},_parse:function(e,r){return typeof e=="string"?r.parse(e,this):e}}),c=(l.kdf={}).OpenSSL={execute:function(e,r,d,t){t||(t=g.random(8));var n=w.create({keySize:r+d}).compute(e,t),v=g.create(n.words.slice(r),4*d);return n.sigBytes=4*r,_.create({key:n,iv:v,salt:t})}},B=o.PasswordBasedCipher=h.extend({cfg:h.cfg.extend({kdf:c}),encrypt:function(e,r,d,t){var n=(t=this.cfg.extend(t)).kdf.execute(d,e.keySize,e.ivSize);t.iv=n.iv;var v=h.encrypt.call(this,e,r,n.key,t);return v.mixIn(n),v},decrypt:function(e,r,d,t){t=this.cfg.extend(t),r=this._parse(r,t.format);var n=t.kdf.execute(d,e.keySize,e.ivSize,r.salt);return t.iv=n.iv,h.decrypt.call(this,e,r,n.key,t)}})}(),function(){var p=s,l=p.lib.BlockCipher,o=p.algo,a=[],g=[],y=[],S=[],m=[],w=[],k=[],C=[],D=[],i=[];(function(){for(var u=[],h=0;h<256;h++)u[h]=h<128?h<<1:h<<1^283;var c=0,B=0;for(h=0;h<256;h++){var e=B^B<<1^B<<2^B<<3^B<<4;e=e>>>8^255&e^99,a[c]=e,g[e]=c;var r=u[c],d=u[r],t=u[d],n=257*u[e]^16843008*e;y[c]=n<<24|n>>>8,S[c]=n<<16|n>>>16,m[c]=n<<8|n>>>24,w[c]=n,n=16843009*t^65537*d^257*r^16843008*c,k[e]=n<<24|n>>>8,C[e]=n<<16|n>>>16,D[e]=n<<8|n>>>24,i[e]=n,c?(c=r^u[u[u[t^r]]],B^=u[u[B]]):c=B=1}})();var f=[0,1,2,4,8,16,32,64,128,27,54],_=o.AES=l.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var u=this._keyPriorReset=this._key,h=u.words,c=u.sigBytes/4,B=4*((this._nRounds=c+6)+1),e=this._keySchedule=[],r=0;r<B;r++)r<c?e[r]=h[r]:(n=e[r-1],r%c?c>6&&r%c==4&&(n=a[n>>>24]<<24|a[n>>>16&255]<<16|a[n>>>8&255]<<8|a[255&n]):(n=a[(n=n<<8|n>>>24)>>>24]<<24|a[n>>>16&255]<<16|a[n>>>8&255]<<8|a[255&n],n^=f[r/c|0]<<24),e[r]=e[r-c]^n);for(var d=this._invKeySchedule=[],t=0;t<B;t++){if(r=B-t,t%4)var n=e[r];else n=e[r-4];d[t]=t<4||r<=4?n:k[a[n>>>24]]^C[a[n>>>16&255]]^D[a[n>>>8&255]]^i[a[255&n]]}}},encryptBlock:function(u,h){this._doCryptBlock(u,h,this._keySchedule,y,S,m,w,a)},decryptBlock:function(u,h){var c=u[h+1];u[h+1]=u[h+3],u[h+3]=c,this._doCryptBlock(u,h,this._invKeySchedule,k,C,D,i,g),c=u[h+1],u[h+1]=u[h+3],u[h+3]=c},_doCryptBlock:function(u,h,c,B,e,r,d,t){for(var n=this._nRounds,v=u[h]^c[0],b=u[h+1]^c[1],M=u[h+2]^c[2],E=u[h+3]^c[3],z=4,P=1;P<n;P++){var O=B[v>>>24]^e[b>>>16&255]^r[M>>>8&255]^d[255&E]^c[z++],A=B[b>>>24]^e[M>>>16&255]^r[E>>>8&255]^d[255&v]^c[z++],R=B[M>>>24]^e[E>>>16&255]^r[v>>>8&255]^d[255&b]^c[z++],T=B[E>>>24]^e[v>>>16&255]^r[b>>>8&255]^d[255&M]^c[z++];v=O,b=A,M=R,E=T}O=(t[v>>>24]<<24|t[b>>>16&255]<<16|t[M>>>8&255]<<8|t[255&E])^c[z++],A=(t[b>>>24]<<24|t[M>>>16&255]<<16|t[E>>>8&255]<<8|t[255&v])^c[z++],R=(t[M>>>24]<<24|t[E>>>16&255]<<16|t[v>>>8&255]<<8|t[255&b])^c[z++],T=(t[E>>>24]<<24|t[v>>>16&255]<<16|t[b>>>8&255]<<8|t[255&M])^c[z++],u[h]=O,u[h+1]=A,u[h+2]=R,u[h+3]=T},keySize:8});p.AES=l._createHelper(_)}(),s});module.exports=K;
